## 20190802

[TOC]

### Running frist app on kubernetes

简单起见，可以使用kubectl run 命令创建所有必须的组件

```
lucheng@ubuntu_18_04:~/test$ sudo kubectl run kubia --image=kubia --port=8899 --generator=run/v1
kubectl run --generator=run/v1 is DEPRECATED and will be removed in a future version. Use kubectl run --generator=run-pod/v1 or kubectl create instead.
replicationcontroller/kubia created

lucheng@ubuntu_18_04:~$ sudo kubectl get pods --all-namespaces
NAMESPACE     NAME                          READY   STATUS              RESTARTS   AGE
kube-system   kube-addon-manager-minikube   0/1     ContainerCreating   0          28m

lucheng@ubuntu_18_04:~$ sudo kubectl describe pod kubia-8jrw9
Events:
  Type     Reason                  Age                   From               Message
  ----     ------                  ----                  ----               -------
  Normal   Scheduled               19m                   default-scheduler  Successfully assigned kubia-8jrw9 to minikube
  Normal   SuccessfulMountVolume   19m                   kubelet, minikube  MountVolume.SetUp succeeded for volume "default-token-k7bkr"
  Warning  FailedCreatePodSandBox  4m51s (x31 over 19m)  kubelet, minikube  Failed create pod sandbox.
```

问题：

查看pods状态一直是ContainerCreating，使用kubectl describe pod 查看event 发现

```
journalctl -u kubelet
```



删除pods

```
lucheng@ubuntu_18_04:~$ sudo kubectl get pods
NAME          READY   STATUS              RESTARTS   AGE
kubia-8jrw9   0/1     ContainerCreating   0          17h
lucheng@ubuntu_18_04:~$ sudo kubectl delete pods kubia-8jrw9
pod "kubia-8jrw9" deleted
lucheng@ubuntu_18_04:~$ sudo kubectl get pods
NAME          READY   STATUS              RESTARTS   AGE
kubia-8xvkz   0/1     ContainerCreating   0          7s

//发现直接删除pod，又创建了一个新的pod，需要删除rc
lucheng@ubuntu_18_04:~$ sudo kubectl get rc
NAME    DESIRED   CURRENT   READY   AGE
kubia   1         1         0       17h

```



创建一个service object

kubectl expose rc kubia --type=LoadBalancer --name kubia-http

