## 20201030

[TOC]

### 白话深度学习与TensorFlow

深度学习是非常典型的计算密集型的应用领域，普通机器无法胜任。

深度学习从其解决问题的根本理论方面需要比较深厚和扎实的数学基础，尤其是高等数学、线性代数、泛函分析及其延伸学科的基础。



cpu越来越强大了，再加上GPU的普及

有现成的框架TensorFlow、pyTorch、Caffe等来搭建环境

大家可以共享训练好的模型（一个可下载的模型描述文件，**里面是网络的节点权重和拓扑结构信息**）



人工智能？

机器学习是什么？

深度学习是什么？



人工智能是一类非常广泛的问题，它旨在通过计算机实现类似人类的智能。机器学习是解决人工智能问题的一个重要方法。深度学习则是机器学习的一个分支，它在很多领域突破了传统机器学习的瓶颈，将人工智能推向了一个新的高潮。



人类学习的目的是：掌握知识、掌握能力、掌握技巧，最终能够进行比较复杂或高要求的工作。

类比，机器学习的目的是让他独立或至少半独立地进行相对复杂或者高要求的工作。

本质性目的就是：**让机器帮助人类做一些大规模的数据识别、分拣、规律总结等人类做起来比较花时间的事情。**



算法这种东西在最初出现的时候是一种确定性的机器指令执行序列，机器需要怎么做是早在程序一开始就设定好的。没有任何“学习”的行为



一个基本完整的有监督学习（supervised learning）的学习过程

比如，有一个分类器，可以将输入的邮件分拣为“普通邮件”和“垃圾邮件”两个类别。但垃圾邮件的判断标准不是在程序运行伊始给出的，而是在给予分类器大量垃圾邮件后，由分类器对垃圾邮件样本的各种特征进行统计和归纳，进而得到的。

训练样本-大量被标注为垃圾邮件的邮件

**训练**-分类器对垃圾邮件样本的特征进行统计和归纳的过程

分类模型-总结出来的判断标准

验证-把一些普通邮件和垃圾邮件给予分类器，让它尝试根据刚刚总结好的分类模型进行分类，看看它分类的正确性是否确实具有泛化性

测试-使用一定量的普通邮件和垃圾邮件去测试这个模型的识别能力



机器学习从学习的种类来说，分为无监督学习，一种叫有监督学习。

无监督学习，是指人们获得训练的向量数据后在没有标签的情况下尝试找出其内部蕴含关系的一种挖掘工具，这个过程中使用者除了可能要设置一些必要的超参数以外，不用对这些样本做任何的标记甚至是过程干预。



**聚类**clustering

无监督学习，是把物理对象或抽象对象的集合分组为由彼此类似的对象组成的多个类的分析过程。

人类学习的过程就是“偷懒性”的选择了归纳归类的方式。

比较常见的聚类算法有K-Means/DBSCAN等，利用每个向量之间的距离，从远近判断是否从属于同一类别



**回归**regression

由果索因是一种归纳的思想，一类是线性回归，一类是非线性回归。

Loss=f(w, b)

使用相应的方法找出保证Loss尽可能小的w和b的取值。



**分类**

通常把分类算法叫做分类器

召回率：200张猫，正确识别出180张，所以猫的召回率是180/200=90%

准确率：

人其实就是一种极为复杂的且极为智能的分类器



### kubeflow

https://baijiahao.baidu.com/s?id=1664180482170496561&wfr=spider&for=pc





### TensorFlow的安装

- 使用docker安装
- 使用pip安装
- 源码安装方式



推理是什么概念？跟训练有什么关系？

经过训练（training）的神经网络可以将其所学到的知识应用于数字世界的任务，神经网络可以基于其所训练的内容对其所获得的新数据进行「推导」，用人工智能领域的术语来说是「推理（inference）」



NVIDIA TensorRT™ 是用于高性能深度学习推理的 SDK。此 SDK 包含深度学习推理优化器和运行时环境，可为深度学习推理应用提供低延迟和高吞吐量。



``` python
import tensorflow as tf

tf.__version__
'2.0.0'
```



### 模型推理部署

Tensorflow 模型保存、加载方式

常见的模型保存后产生的文件有以下几种方式：

1. checkpoint

.data文件是包含训练变量的文件

.index描述variable中key和value的对应关系

.meta文件保存了tensorflow完整的网络图结构

2. GraphDef

pb文件

protobuf对象序列化后的数据,包含了计算图和变量。

3. SavedModel

pb文件+variable目录

后面两种形式包含权重和计算图操作



我们可以训练时使用python语言，推理时也使用python语言。使用flask等web开发框架，用restful API的方式部署服务。



tensorflow serving 提供多模型部署、服务通信、模型管理等，我们可以使用tensorflow serving 来部署模型，撰写客户端来进行数据预处理和后处理以及与服务端的交互。

https://www.tensorflow.org/tfx/guide/serving



tensorRT进行模型操作转换，来进行推理加速。

![img](pics/TensorFlow_20201030/%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1%E6%88%AA%E5%9B%BE_16043960013945.png)

